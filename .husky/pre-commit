echo "üîç Running pre-commit checks..."

# Run lint-staged for staged files only
echo "üìù Formatting and linting staged files..."
npx lint-staged

# Quick syntax check on staged TypeScript/Svelte files
STAGED_TS_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|svelte)$' | head -5 || true)
if [ -n "$STAGED_TS_FILES" ]; then
    echo "üîß Quick syntax check on staged files..."
    npx svelte-check --threshold warning --tsconfig ./tsconfig.json $STAGED_TS_FILES 2>/dev/null || echo "‚ö†Ô∏è  Type check warnings found (commit allowed)"
else
    echo "‚è≠Ô∏è  No TypeScript/Svelte files to check"
fi

echo "‚úÖ Pre-commit checks completed!"
